<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body {background:#111;color:#fff;font-family:Arial;padding:20px;}
        .box {width:600px;margin:auto;background:#1b1b1b;padding:25px;border-radius:10px;}
        input, textarea {
            width:100%;padding:12px;margin-top:10px;
            background:#2b2b2b;border:none;color:#fff;border-radius:6px;
        }
        button {
            width:100%;padding:15px;margin-top:15px;
            background:#00eaff;border:none;border-radius:6px;
            font-size:17px;font-weight:bold;color:#000;cursor:pointer;
        }
        .loader {display:none;text-align:center;margin-top:15px;font-size:18px;}
        .popup {
            display:none;position:fixed;top:0;left:0;width:100%;height:100%;
            background:rgba(0,0,0,0.7);justify-content:center;align-items:center;
        }
        .popup-box {background:#222;padding:25px;border-radius:10px;text-align:center;width:300px;}
        .logout {color:#fff;background:#ff4444;padding:10px 18px;text-decoration:none;border-radius:6px;}
    </style>
</head>
<body>

<div style="display:flex;justify-content:space-between;margin-bottom:20px;">
    <h2>Email Sender</h2>
    <a class="logout" href="/logout">Logout</a>
</div>

<div class="box">

    <label>Your Gmail</label>
    <input id="email" placeholder="yourgmail@gmail.com">

    <label>Password / App Password</label>
    <input id="password" type="password" placeholder="your gmail password">

    <label>Subject</label>
    <input id="subject" placeholder="Enter subject">

    <label>Message</label>
    <textarea id="message" rows="5" placeholder="Enter your message here"></textarea>

    <label>Emails (One per line)</label>
    <textarea id="emails" rows="6" placeholder="email1@gmail.com&#10;email2@gmail.com"></textarea>

    <button onclick="sendMail()">Send Emails</button>

    <div class="loader" id="loader">⏳ Sending...</div>
</div>


<div class="popup" id="popup">
    <div class="popup-box">
        <h3>✅ Emails Sent</h3>
        <p id="summary"></p>
        <button onclick="closePopup()">OK</button>
    </div>
</div>


<script>
function sendMail() {
    let data = {
        email: document.getElementById("email").value,
        password: document.getElementById("password").value,
        subject: document.getElementById("subject").value,
        message: document.getElementById("message").value,
        emails: document.getElementById("emails").value
    };

    document.getElementById("loader").style.display = "block";

    fetch("/send-mails", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(out => {
        document.getElementById("loader").style.display = "none";
        document.getElementById("summary").innerHTML =
            `Total: ${out.total}<br>Success: ${out.success}<br>Failed: ${out.failed}`;
        document.getElementById("popup").style.display = "flex";
    });
}

function closePopup() {
    document.getElementById("popup").style.display = "none";
}
</script>

</body>
</html>
